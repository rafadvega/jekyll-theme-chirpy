<!DOCTYPE html><html lang="es" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos" /><meta name="author" content="Rafa de Vega" /><meta property="og:locale" content="es" /><meta name="description" content="Configurando la auditoría de los sistemas operativos" /><meta property="og:description" content="Configurando la auditoría de los sistemas operativos" /><link rel="canonical" href="https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/" /><meta property="og:url" content="https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/" /><meta property="og:site_name" content="rdevega" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-29T05:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Rafa de Vega"},"dateModified":"2023-05-20T22:58:59+02:00","datePublished":"2021-07-29T05:33:00+02:00","description":"Configurando la auditoría de los sistemas operativos","headline":"Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos","mainEntityOfPage":{"@type":"WebPage","@id":"https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/"},"url":"https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/"}</script><title>Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos | rdevega</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rdevega"><meta name="application-name" content="rdevega"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="es"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/images/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rdevega</a></div><div class="site-subtitle font-italic">Blog sobre ciberseguridad centrado en Threat Hunting e IR</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVOS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rafadvega" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/rdevega" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['rafadevega','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Rafa de Vega </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 29, 2021, 5:33 AM +0200" >Jul 29, 2021<i class="unloaded">2021-07-29T05:33:00+02:00</i> </span></div><div> <span> Actualizado <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, May 20, 2023, 9:58 PM +0100" >May 20<i class="unloaded">2023-05-20T22:58:59+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="466 words">2 min leer</span></div></div><div class="post-content"><h1 id="configurando-la-auditoría-de-los-sistemas-operativos">Configurando la auditoría de los sistemas operativos</h1><h2 id="auditoría-de-windows">Auditoría de Windows</h2><p>La auditoría de Windows la configuraremos mediante una GPO, para que aplique tanto al DC como a las máquinas que añadamos al dominio. Para ello, buscaremos el “Group Policy Management” y crearemos una política en “Group Policy Objects” de forma idéntica a como lo hicimos en posts anteriores.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img1.bmp" alt="img" width="1086" height="542" /></p><p>Editamos la política, y en el editor de políticas, abrimos el árbol tal y como se muestra en la imagen y veremos como configurar las políticas generales:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img2.bmp" alt="img" width="1086" height="542" /></p><p>En cada política, podemos configurar la auditoría de fallos y aciertos:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img3.bmp" alt="img" width="1086" height="542" /></p><p>Para configurar estas políticas, podemos seguir las <a href="https://docs.microsoft.com/es-es/windows-server/identity/ad-ds/plan/security-best-practices/audit-policy-recommendations">recomendaciones de microsoft</a>. En este caso las dejaremos como sigue:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img4.bmp" alt="img" width="1086" height="542" /></p><p>Continuamos modificando las políticas de auditoría avanzadas, dejándolas como sigue en las capturas siguientes:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img5.bmp" alt="img" width="1086" height="542" /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img6.bmp" alt="img" width="1086" height="542" /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img7.bmp" alt="img" width="1086" height="542" /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img8.bmp" alt="img" width="1086" height="542" /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img9.bmp" alt="img" width="1086" height="542" /></p><p>Con esto, tendremos auditadas las creaciones de procesos, pero no veremos el comando usado para lanzarlos. Para esto habitaremos la siguiente política:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img10.bmp" alt="img" width="1086" height="542" /></p><p>Por último, linkaremos la política al dominio:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img11.bmp" alt="img" width="1086" height="542" /></p><p>Una vez realizado esto, podemos listar las auditorías de la máquina con el comando:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>auditpol /get /category:<span class="k">*</span>
</pre></table></code></div></div><p>y deberíamos ver lo siguiente:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img12.bmp" alt="img" width="1086" height="542" /></p><p>En cualquier máquina del dominio, deberíamos tener también estas políticas configuradas.</p><h2 id="sysmon">Sysmon</h2><p>Además de esta auditoría de windows, será interesante tener desplegado Sysmon, que aunque se pisa bastante con la configuración que hemos realizado, nos dará mayores posibilidades de detección. Para instalar sysmon, descargaremos su binario de la <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">web de sysinternals</a>. También necesitaremos crear una configuración para sysmon. Podemos empezar la configuración del siguiente <a href="https://raw.githubusercontent.com/SwiftOnSecurity/sysmon-config/master/sysmonconfig-export.xml">enlace</a></p><p>Le añadiremos una linea para evitar que nos llegue las ejecuciones del agente de Splunk que instalaremos más tarde:</p><div lang="xml" class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;Image</span> <span class="na">condition=</span><span class="s">"is"</span><span class="nt">&gt;</span>C:\Program Files\SplunkUniversalForwarder\bin\*<span class="nt">&lt;/Image&gt;</span>
</pre></table></code></div></div><p>Deberemos hacerlo en la sección indicada tal y como se ve en la imagen:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img13.bmp" alt="img" width="1086" height="542" /></p><p>Por último, incluimos en el mismo directorio el binario de sysmon y el fichero de configuración, instalaremos sysmon con el siguiente comando:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>.<span class="se">\S</span>ysmon64.exe <span class="nt">-i</span>
</pre></table></code></div></div><p>Y aplicaremos la configuración con el siguiente comando:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>.<span class="se">\S</span>ysmon64.exe <span class="nt">-c</span> .<span class="se">\s</span>ysmonconfig-export.xml
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img15.bmp" alt="img" width="1086" height="542" /></p><p>Desde el visor de Eventos de windows, podemos observar que ya tenemos eventos de Sysmon:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditWindows/img16.bmp" alt="img" width="1086" height="542" /></p><h2 id="auditd">Auditd</h2><p>En el caso de Linux, tendremos que usar Auditd para la auditoría. Nuestro RedHat ya debería venir con el servicio instalado, en otras distribuciones quizá haya que instalarlo.</p><p>Aunque está instalado, si ejecutamos el siguiente comando:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>auditctl <span class="nt">-l</span>
</pre></table></code></div></div><p>Veremos que no tenemos ninguna regla configurada. Para configurar reglas de audit, podemos empezar a usar <a href="https://github.com/bfuzzy/auditd-attack/blob/master/auditd-attack.rules">esta lista pública de reglas</a> que está mapeada con el framwork Mitre ATT&amp;CK. La descargamos y la copiamos en la ruta /etc/auditd/rules.d/</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditd/img2.bmp" alt="img" width="1086" height="542" /></p><p>Deberemos borrar el otro fichero que hay en esa ruta, o quitarle el parámetro -D al mismo. Una vez realizado esto, reiniciaremos el servicio:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>service auditd restart
</pre></table></code></div></div><p>Y si volvemos listar las reglas, ahora sí deberíamos ver la lista completa:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/auditd/img3.bmp" alt="img" width="1086" height="542" /></p><p>Con esto, nuestra auditoría debería estar completa, sólo queda llevarla a nuestro Splunk.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/threat-hunting/'>Threat Hunting</a>, <a href='/categories/laboratorio/'>Laboratorio</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/threat-hunting/" class="post-tag no-text-decoration" >threat hunting</a> <a href="/tags/hunting/" class="post-tag no-text-decoration" >hunting</a> <a href="/tags/laboratorio/" class="post-tag no-text-decoration" >laboratorio</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/redhat/" class="post-tag no-text-decoration" >redhat</a> <a href="/tags/auditor%C3%ADa/" class="post-tag no-text-decoration" >auditoría</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esto es un post bajo licencia <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> .</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://es.linkedin.com/in/rdevega" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos - rdevega&u=https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos - rdevega&url=https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copiado!')" data-toggle="tooltip" data-placement="top" title="Copiar Link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Última actualización</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Creando-un-laboratorio-para-threat-hunting-v/">Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos</a><li><a href="/posts/Creando-un-laboratorio-para-threat-hunting-vi/">Creando un laboratorio para threat hunting VI. Desplegando Splunk</a><li><a href="/posts/Creando-un-laboratorio-para-threat-hunting-i/">Creando un laboratorio para threat hunting I. Introducción</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/laboratorio/">laboratorio</a> <a class="post-tag" href="/tags/threat-hunting/">threat hunting</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/redhat/">redhat</a> <a class="post-tag" href="/tags/auditor%C3%ADa/">auditoría</a> <a class="post-tag" href="/tags/dc/">dc</a> <a class="post-tag" href="/tags/domain-controller/">domain controller</a> <a class="post-tag" href="/tags/firewall/">firewall</a> <a class="post-tag" href="/tags/pfsense/">pfsense</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contenidos</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Creando-un-laboratorio-para-threat-hunting-iv/"><div class="card-body"> <span class="timeago small" >Jul 22, 2021<i class="unloaded">2021-07-22T05:33:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Creando un laboratorio para threat hunting IV. Desplegando Máquinas del dominio</h3><div class="text-muted small"><p> Desplegando Máquinas del dominio Instalación de Windows 10 Antes de ponernos a instalar la máquina, ejecutaremos en el controlador de dominio el siguiente comando: Que hará que cada vez que un...</p></div></div></a></div><div class="card"> <a href="/posts/Creando-un-laboratorio-para-threat-hunting-iii/"><div class="card-body"> <span class="timeago small" >Jul 15, 2021<i class="unloaded">2021-07-15T05:33:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Creando un laboratorio para threat hunting III. Desplegando Controlador de dominio</h3><div class="text-muted small"><p> Desplegando el Controlador de Dominio. Instalación del servidor El siguiente paso en nuestro despliegue, será desplegar el controlador de dominio. Para ello, emplearemos una versión de evaluación ...</p></div></div></a></div><div class="card"> <a href="/posts/Creando-un-laboratorio-para-threat-hunting-i/"><div class="card-body"> <span class="timeago small" >Jul 1, 2021<i class="unloaded">2021-07-01T05:33:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Creando un laboratorio para threat hunting I. Introducción</h3><div class="text-muted small"><p> En esta serie de posts, nos centraremos en crear un pequeño laboratorio para nuestros ejercicios de threat hunting, existen varias soluciones ya automatizadas. como pueden ser DetectionLab o adaz,...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Creando-un-laboratorio-para-threat-hunting-iv/" class="btn btn-outline-primary" prompt="Older"><p>Creando un laboratorio para threat hunting IV. Desplegando Máquinas del dominio</p></a> <a href="/posts/Creando-un-laboratorio-para-threat-hunting-vi/" class="btn btn-outline-primary" prompt="Newer"><p>Creando un laboratorio para threat hunting VI. Desplegando Splunk</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//rafadvega.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Creando un laboratorio para threat hunting V. Configurando la auditoría de los sistemas operativos'; this.page.url = 'https://rafadvega.github.io/posts/Creando-un-laboratorio-para-threat-hunting-v/'; this.page.identifier = '/posts/Creando-un-laboratorio-para-threat-hunting-v/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/rdevega">Rafa de Vega</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hunting/">hunting</a> <a class="post-tag" href="/tags/laboratorio/">laboratorio</a> <a class="post-tag" href="/tags/threat-hunting/">threat hunting</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/redhat/">redhat</a> <a class="post-tag" href="/tags/auditor%C3%ADa/">auditoría</a> <a class="post-tag" href="/tags/dc/">dc</a> <a class="post-tag" href="/tags/domain-controller/">domain controller</a> <a class="post-tag" href="/tags/firewall/">firewall</a> <a class="post-tag" href="/tags/pfsense/">pfsense</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rafadvega.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No se han encontrado resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-MWKT6JFF0L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-MWKT6JFF0L'); }); </script>
